"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var fs = require("fs");
var path = require("path");
var pathSep = require("path").sep;
function StaticFileSystemAdapter(options) {
    options = options || {};
    let filesSubDirectory = options.filesSubDirectory || "";
    this._filesDir = filesSubDirectory;
    this._mkdir(this._getApplicationDir());
    if (!this._applicationDirExist()) {
        throw "Files directory doesn't exist.";
    }
    return this;
}
exports.default = StaticFileSystemAdapter;
StaticFileSystemAdapter.prototype.createFile = function (filename, data) {
    return new Promise((resolve, reject) => {
        let filepath = this._getLocalFilePath(filename);
        fs.writeFile(filepath, data, err => {
            if (err !== null) {
                return reject(err);
            }
            resolve(data);
        });
    });
};
StaticFileSystemAdapter.prototype.deleteFile = function (filename) {
    return new Promise((resolve, reject) => {
        let filepath = this._getLocalFilePath(filename);
        fs.readFile(filepath, function (err, data) {
            if (err !== null) {
                return reject(err);
            }
            fs.unlink(filepath, unlinkErr => {
                if (err !== null) {
                    return reject(unlinkErr);
                }
                resolve(data);
            });
        });
    });
};
StaticFileSystemAdapter.prototype.getFileData = function (filename) {
    return new Promise((resolve, reject) => {
        let filepath = this._getLocalFilePath(filename);
        fs.readFile(filepath, function (err, data) {
            if (err !== null) {
                return reject(err);
            }
            resolve(data);
        });
    });
};
StaticFileSystemAdapter.prototype.getFileLocation = function (config, filename) {
    return (config.mount +
        "/files/" +
        config.applicationId +
        "/" +
        encodeURIComponent(filename));
};
/*
  Helpers
 --------------- */
StaticFileSystemAdapter.prototype._getApplicationDir = function () {
    if (this._filesDir) {
        return this._filesDir; //path.join("files", this._filesDir);
    }
    else {
        return "files";
    }
};
StaticFileSystemAdapter.prototype._applicationDirExist = function () {
    return fs.existsSync(this._getApplicationDir());
};
StaticFileSystemAdapter.prototype._getLocalFilePath = function (filename) {
    let applicationDir = this._getApplicationDir();
    if (!fs.existsSync(applicationDir)) {
        this._mkdir(applicationDir);
    }
    return path.join(applicationDir, encodeURIComponent(filename));
};
StaticFileSystemAdapter.prototype._mkdir = function (dirPath) {
    // snippet found on -> https://gist.github.com/danherbert-epam/3960169
    let dirs = dirPath.split(pathSep);
    var root = "";
    while (dirs.length > 0) {
        var dir = dirs.shift();
        if (dir === "") {
            // If directory starts with a /, the first path will be an empty string.
            root = pathSep;
        }
        if (!fs.existsSync(path.join(root, dir))) {
            try {
                fs.mkdirSync(path.join(root, dir));
            }
            catch (e) {
                if (e.code == "EACCES") {
                    throw new Error("PERMISSION ERROR: In order to use the FileSystemAdapter, write access to the server's file system is required.");
                }
            }
        }
        root = path.join(root, dir, pathSep);
    }
};
// module.exports = FileSystemAdapter;
// module.exports.default = FileSystemAdapter;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RhdGljRmlsZVN5c3RlbUFkYXB0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJTdGF0aWNGaWxlU3lzdGVtQWRhcHRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQUksRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN2QixJQUFJLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDM0IsSUFBSSxPQUFPLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUVsQyxpQ0FBZ0QsT0FBTztJQUNyRCxPQUFPLEdBQUcsT0FBTyxJQUFJLEVBQUUsQ0FBQztJQUN4QixJQUFJLGlCQUFpQixHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsSUFBSSxFQUFFLENBQUM7SUFDeEQsSUFBSSxDQUFDLFNBQVMsR0FBRyxpQkFBaUIsQ0FBQztJQUNuQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLENBQUM7SUFDdkMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDakMsTUFBTSxnQ0FBZ0MsQ0FBQztJQUN6QyxDQUFDO0lBQ0QsTUFBTSxDQUFDLElBQUksQ0FBQztBQUNkLENBQUM7QUFURCwwQ0FTQztBQUVELHVCQUF1QixDQUFDLFNBQVMsQ0FBQyxVQUFVLEdBQUcsVUFBUyxRQUFRLEVBQUUsSUFBSTtJQUNwRSxNQUFNLENBQUMsSUFBSSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7UUFDckMsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hELEVBQUUsQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxHQUFHLENBQUMsRUFBRTtZQUNqQyxFQUFFLENBQUMsQ0FBQyxHQUFHLEtBQUssSUFBSSxD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QUM7Z0JBQ0osQ0FBQztZQUNILENBQUM7UUFDSCxDQUFDO1FBQ0QsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN2QyxDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRUYsc0NBQXNDO0FBQ3RDLDhDQUE4QyIsInNvdXJjZXNDb250ZW50IjpbInZhciBmcyA9IHJlcXVpcmUoXCJmc1wiKTtcbnZhciBwYXRoID0gcmVxdWlyZShcInBhdGhcIik7XG52YXIgcGF0aFNlcCA9IHJlcXVpcmUoXCJwYXRoXCIpLnNlcDtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gU3RhdGljRmlsZVN5c3RlbUFkYXB0ZXIob3B0aW9ucykge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgbGV0IGZpbGVzU3ViRGlyZWN0b3J5ID0gb3B0aW9ucy5maWxlc1N1YkRpcmVjdG9yeSB8fCBcIlwiO1xuICB0aGlzLl9maWxlc0RpciA9IGZpbGVzU3ViRGlyZWN0b3J5O1xuICB0aGlzLl9ta2Rpcih0aGlzLl9nZXRBcHBsaWNhdGlvbkRpcigpKTtcbiAgaWYgKCF0aGlzLl9hcHBsaWNhdGlvbkRpckV4aXN0KCkpIHtcbiAgICB0aHJvdyBcIkZpbGVzIGRpcmVjdG9yeSBkb2Vzbid0IGV4aXN0LlwiO1xuICB9XG4gIHJldHVybiB0aGlzO1xufVxuXG5TdGF0aWNGaWxlU3lzdGVtQWRhcHRlci5wcm90b3R5cGUuY3JlYXRlRmlsZSA9IGZ1bmN0aW9uKGZpbGVuYW1lLCBkYXRhKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgbGV0IGZpbGVwYXRoID0gdGhpcy5fZ2V0TG9jYWxGaWxlUGF0aChmaWxlbmFtZSk7XG4gICAgZnMud3JpdGVGaWxlKGZpbGVwYXRoLCBkYXRhLCBlcnIgPT4ge1xuICAgICAgaWYgKGVyciAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICB9XG4gICAgICByZXNvbHZlKGRhdGEpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cblN0YXRpY0ZpbGVTeXN0ZW1BZGFwdGVyLnByb3RvdHlwZS5kZWxldGVGaWxlID0gZnVuY3Rpb24oZmlsZW5hbWUpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBsZXQgZmlsZXBhdGggPSB0aGlzLl9nZXRMb2NhbEZpbGVQYXRoKGZpbGVuYW1lKTtcbiAgICBmcy5yZWFkRmlsZShmaWxlcGF0aCwgZnVuY3Rpb24oZXJyLCBkYXRhKSB7XG4gICAgICBpZiAoZXJyICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcbiAgICAgIH1cbiAgICAgIGZzLnVubGluayhmaWxlcGF0aCwgdW5saW5rRXJyID0+IHtcbiAgICAgICAgaWYgKGVyciAhPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiByZWplY3QodW5saW5rRXJyKTtcbiAgICAgICAgfVxuICAgICAgICByZXNvbHZlKGRhdGEpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuU3RhdGljRmlsZVN5c3RlbUFkYXB0ZXIucHJvdG90eXBlLmdldEZpbGVEYXRhID0gZnVuY3Rpb24oZmlsZW5hbWUpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBsZXQgZmlsZXBhdGggPSB0aGlzLl9nZXRMb2NhbEZpbGVQYXRoKGZpbGVuYW1lKTtcbiAgICBmcy5yZWFkRmlsZShmaWxlcGF0aCwgZnVuY3Rpb24oZXJyLCBkYXRhKSB7XG4gICAgICBpZiAoZXJyICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcbiAgICAgIH1cbiAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuU3RhdGljRmlsZVN5c3RlbUFkYXB0ZXIucHJvdG90eXBlLmdldEZpbGVMb2NhdGlvbiA9IGZ1bmN0aW9uKGNvbmZpZywgZmlsZW5hbWUpIHtcbiAgcmV0dXJuIChcbiAgICBjb25maWcubW91bnQgK1xuICAgIFwiL2ZpbGVzL1wiICtcbiAgICBjb25maWcuYXBwbGljYXRpb25JZCArXG4gICAgXCIvXCIgK1xuICAgIGVuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZSlcbiAgKTtcbn07XG5cbi8qXG4gIEhlbHBlcnNcbiAtLS0tLS0tLS0tLS0tLS0gKi9cblN0YXRpY0ZpbGVTeXN0ZW1BZGFwdGVyLnByb3RvdHlwZS5fZ2V0QXBwbGljYXRpb25EaXIgPSBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMuX2ZpbGVzRGlyKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZpbGVzRGlyOy8vcGF0aC5qb2luKFwiZmlsZXNcIiwgdGhpcy5fZmlsZXNEaXIpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBcImZpbGVzXCI7XG4gIH1cbn07XG5cblN0YXRpY0ZpbGVTeXN0ZW1BZGFwdGVyLnByb3RvdHlwZS5fYXBwbGljYXRpb25EaXJFeGlzdCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gZnMuZXhpc3RzU3luYyh0aGlzLl9nZXRBcHBsaWNhdGlvbkRpcigpKTtcbn07XG5cblN0YXRpY0ZpbGVTeXN0ZW1BZGFwdGVyLnByb3RvdHlwZS5fZ2V0TG9jYWxGaWxlUGF0aCA9IGZ1bmN0aW9uKGZpbGVuYW1lKSB7XG4gIGxldCBhcHBsaWNhdGlvbkRpciA9IHRoaXMuX2dldEFwcGxpY2F0aW9uRGlyKCk7XG4gIGlmICghZnMuZXhpc3RzU3luYyhhcHBsaWNhdGlvbkRpcikpIHtcbiAgICB0aGlzLl9ta2RpcihhcHBsaWNhdGlvbkRpcik7XG4gIH1cbiAgcmV0dXJuIHBhdGguam9pbihhcHBsaWNhdGlvbkRpciwgZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVuYW1lKSk7XG59O1xuXG5TdGF0aWNGaWxlU3lzdGVtQWRhcHRlci5wcm90b3R5cGUuX21rZGlyID0gZnVuY3Rpb24oZGlyUGF0aCkge1xuICAvLyBzbmlwcGV0IGZvdW5kIG9uIC0+IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2RhbmhlcmJlcnQtZXBhbS8zOTYwMTY5XG4gIGxldCBkaXJzID0gZGlyUGF0aC5zcGxpdChwYXRoU2VwKTtcbiAgdmFyIHJvb3QgPSBcIlwiO1xuXG4gIHdoaWxlIChkaXJzLmxlbmd0aCA+IDApIHtcbiAgICB2YXIgZGlyID0gZGlycy5zaGlmdCgpO1xuICAgIGlmIChkaXIgPT09IFwiXCIpIHtcbiAgICAgIC8vIElmIGRpcmVjdG9yeSBzdGFydHMgd2l0aCBhIC8sIHRoZSBmaXJzdCBwYXRoIHdpbGwgYmUgYW4gZW1wdHkgc3RyaW5nLlxuICAgICAgcm9vdCA9IHBhdGhTZXA7XG4gICAgfVxuICAgIGlmICghZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4ocm9vdCwgZGlyKSkpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZzLm1rZGlyU3luYyhwYXRoLmpvaW4ocm9vdCwgZGlyKSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGlmIChlLmNvZGUgPT0gXCJFQUNDRVNcIikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgIFwiUEVSTUlTU0lPTiBFUlJPUjogSW4gb3JkZXIgdG8gdXNlIHRoZSBGaWxlU3lzdGVtQWRhcHRlciwgd3JpdGUgYWNjZXNzIHRvIHRoZSBzZXJ2ZXIncyBmaWxlIHN5c3RlbSBpcyByZXF1aXJlZC5cIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcm9vdCA9IHBhdGguam9pbihyb290LCBkaXIsIHBhdGhTZXApO1xuICB9XG59O1xuXG4vLyBtb2R1bGUuZXhwb3J0cyA9IEZpbGVTeXN0ZW1BZGFwdGVyO1xuLy8gbW9kdWxlLmV4cG9ydHMuZGVmYXVsdCA9IEZpbGVTeXN0ZW1BZGFwdGVyO1xuIl19